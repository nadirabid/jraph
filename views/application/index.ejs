<style>






</style>

<article id="application">

	<section class="info-container" v-class="disable-pointer-events:!displayNodeData">
		<div class="info-overlay"></div>

		
		<span class="default-pointer-events" v-component="x-node-create">
			<!--
	 		<button class="btn btn-default node-create" v-class="hidden:displayNodeCreate" v-on="click:displayNodeCreate=true">
	 	  	<span class="glyphicon glyphicon-plus"></span>
	 		</button>
	 		-->
	 		<div class="node-data" v-if="displayNodeCreate">
	 			<div v-if="data">
		 			<ul class="list-unstyled">
		 				<li v-repeat="data"><b>{{$key}}</b>:{{$value}}</li>
		 			</ul>
	 			</div>

				<form class="form-inline">
					<div class="form-group" v-class="has-error:keyHasError">
						<input class="form-control" placeholder="Key" type="text" v-model="key">
					</div>
					<div class="form-group" v-class="has-error:valueHasError">
						<input class="form-control" placeholder="Value" type="text" v-model="value">
					</div>
					<button class="btn btn-default" type="button" v-on="click:addPropertyHandler()">Add</button>
				</form>
				<button class="btn btn-default" v-class="disabled:!data" v-on="click:createNodeHandler()">Create</button>
	 		</div>
		</span>

		<aside class="info-panel" v-component="x-node-data" v-if="displayNodeData">
			<ul class="list-unstyled">
				<li v-repeat="nodeDataList">
					<span v-if="typeof(value)!='object'"><b>{{key}}</b>:{{value}}</span>
					<span v-if="typeof(value)=='object'">
						<b>{{key}}</b>:
						<ul>
							<li v-repeat="value"><b>{{$key}}</b>:{{$value}}</li>
						</ul>
					</span>
				</li>
			</ul>
			<div v-if="addProperty">
				<form class="form-inline">
					<div class="form-group" v-class="has-error:keyHasError">
						<input class="form-control" placeholder="Key" type="text" v-model="key">
					</div>
					<div class="form-group" v-class="has-error:valueHasError">
						<input class="form-control" placeholder="Value" type="text" v-model="value">
					</div>
					<button class="btn btn-default" type="button" v-on="click:savePropertyHandler()">Save</button>
				</form>
			</div>
			<button class="btn btn-default" v-class="hidden:addProperty" v-on="click:addProperty=true">Add</button>
			<button class="btn btn-default" v-class="hidden:!addProperty" v-on="click:addProperty=false">Cancel</button>
		</aside>

	</section>

	<section class="graph-container">
		<svg v-component="x-graph">
			<g class="link"
				 v-bind="x-mouseenter:freezePosition,
				 				 x-mouseleave:releasePosition,
				 				 x-dragstart:dragStart,
				 				 x-drag:drag"
				 v-component="x-link"
				 v-repeat="links"
				 v-svg-events>
				<line v-attr="x1:source.x, y1:source.y, x2:target.x, y2:target.y"></line>
			</g>
			<g class="node"
				 v-attr="transform:'translate('+x+','+y+')'"
				 v-bind="x-mouseenter[state=link_target]:freezePosition, 
				 			   x-mouseleave[state=link_target]:releasePosition, 
				 			   x-mouseenter[state=default]:showMenu, 
				 			   x-mouseleave[state=default]:hideMenu"
				 v-component="x-node"
				 v-ref="nodeVms"
				 v-repeat="nodes"
				 v-svg-events>
				<x-radial-menu v-if="menu">
					<x-radial-button v-bind="click[state=default]:setLinkSource">link</x-radial-button>
					<x-radial-button v-bind="click[state=default]:deleteNode">delete</x-radial-button>
				</x-radial-menu>
				<g>
					<circle class="node-circle"
									v-attr="r:radius"
									v-bind="x-click[state=default]:pin,
												  x-click[state=link_target]:setLinkTarget,
												  x-dragstart[state=default]:dragStart,
												  x-drag[state=default]:drag,
												  x-dragend[state=default]:dragEnd"
				 			 		v-svg-events>
			 		</circle>
					<text class="node-label disable-user-selection disable-pointer-events"
								text-anchor="middle"
								v-attr="transform:'translate('+labelX+','+labelY+')'"
								v-class="invisible:menu">
						Label {{$index}}
					</text>
				</g>
			</g>
		</svg>
	</section>

</article>

<script id="template-radial-button" type="text/x-template">
	<g class="node-menu">
		<path v-attr="d:backgroundPath"></path>
		<path class="node-menu-highlight" v-attr="d:highlightPath"></path>
		<path id="{{id}}" opacity="0" fill="none" v-attr="d:textPath"></path>
		<text class="node-menu-item-label disable-user-selection disable-pointer-events"
					text-anchor="middle"
					v-attr="x:x, dy:dy">
			<textPath xlink:href="#{{id}}">
				<content></content>
			</textPath>
		</text>
	</g>
</script>

<script id="template-radial-menu" type="text/x-template">
	<g>
		<circle class="disable-user-selection" fill-opacity="0" r="80"></circle>
		<g class="content">
			<content></content>
		</g>
	</g>
</script>
