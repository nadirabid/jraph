<div id="application">

	<div class="container-fluid container-overlay" v-class="disable-pointer-events : !displayNodeData">

		<span class="default-pointer-events" v-component="cmp-nodeCreate">
	 		<button class="btn btn-default node-create" v-class="hidden: displayNodeCreate" v-on="click: displayNodeCreate=true">
	 	  	<span class="glyphicon glyphicon-plus"></span>
	 		</button>
	 		<div class="node-data" v-if="displayNodeCreate">
	 			<div v-if="data">
		 			<ul class="list-unstyled">
		 				<li v-repeat="data"><b>{{$key}}</b>: {{$value}}</li>
		 			</ul>
	 			</div>

				<form class="form-inline">
					<div class="form-group" v-class="has-error: keyHasError">
						<input class="form-control" placeholder="Key" type="text" v-model="key">
					</div>
					<div class="form-group" v-class="has-error: valueHasError">
						<input class="form-control" placeholder="Value" type="text" v-model="value">
					</div>
					<button class="btn btn-default" type="button" v-on="click: addPropertyHandler()">Add</button>
				</form>
				<button class="btn btn-default" v-class="disabled: !data" v-on="click: createNodeHandler()">Create</button>
	 		</div>
		</span>

		<div class="node-data" v-component="cmp-nodeData" v-if="displayNodeData">
			<ul class="list-unstyled">
				<li v-repeat="nodeDataList">
					<span v-if="typeof(value)!='object'"><b>{{key}}</b>: {{value}}</span>
					<span v-if="typeof(value)=='object'">
						<b>{{key}}</b>:
						<ul>
							<li v-repeat="value"><b>{{$key}}</b>: {{$value}}</li>
						</ul>
					</span>
				</li>
			</ul>
			<div v-if="addProperty">
				<form class="form-inline">
					<div class="form-group" v-class="has-error: keyHasError">
						<input class="form-control" placeholder="Key" type="text" v-model="key">
					</div>
					<div class="form-group" v-class="has-error: valueHasError">
						<input class="form-control" placeholder="Value" type="text" v-model="value">
					</div>
					<button class="btn btn-default" type="button" v-on="click: savePropertyHandler()">Save</button>
				</form>
			</div>
			<button class="btn btn-default" v-class="hidden: addProperty" v-on="click: addProperty=true">Add</button>
			<button class="btn btn-default" v-class="hidden: !addProperty" v-on="click: addProperty=false">Cancel</button>
		</div>

	</div>

	<svg class="hypergraph" v-attr="width:width, height:height" v-component="cmp-graph">
		
		<g class="link" v-repeat="links">
			<line v-attr="x1:source.x, y1:source.y, x2:target.x, y2:target.y"></line>
		</g>

		<g class="node"
			 v-attr="transform: 'translate('+x+','+y+')'"
			 v-component="cmp-node" 
			 v-repeat="nodes | orderBy cid reverse"
			 v-on="mouseenter : showNodeMenu( $event, $index ),
			 			 mouseleave : hideNodeMenu(),
			 			 mousedown  : dragStart( $event ),
			 			 click      : pin( $event )">			
			<g v-if="nodeMenu">
				<circle class="disable-user-selection" fill-opacity="0" r="80"></circle>
				<g class="node-menu"
					 v-component="cmp-arc"
					 v-repeat="menu">
					<path v-attr="d: backgroundPath"></path>
					<path class="node-menu-highlight" v-attr="d: highlightPath"></path>
					<path id="itemLabel-textPath-{{$index}}" opacity="0" fill="none" v-attr="d: textPath"></path>
					<text class="node-menu-item-label disable-user-selection disable-pointer-events"
								text-anchor="middle"
								v-attr="x: x, dy: dy">
						<textPath xlink:href="#itemLabel-textPath-{{$index}}">{{label | uppercase}}</textPath>
					</text>
				</g>
			</g>
			<circle class="node-circle" v-attr="r: radius"></circle>
			<text text-anchor="middle" class="node-label disable-user-selection disable-pointer-events"
						v-attr="transform: 'translate('+labelX+','+labelY+')'"
						v-class="invisible: nodeMenu">
				Label {{ $index }}
			</text>
		</g>

	</svg>

</div>