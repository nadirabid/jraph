@(hypergraphs: play.api.libs.json.JsValue, userHash: String)

@import play.api.libs.json.Json

<!DOCTYPE html>
<html>
  <head lang="en">
    <meta charset="UTF-8">
    <title>Graphs</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="@routes.Assets.at("style/dependencies/bootstrap.css")">
    <style>
      html, body {
        overflow-x:hidden;
      }

      [v-cloak] {
        display:none !important;
      }

      .x-disable-pointer-events {
        pointer-events: none;
      }

      .x-paper {
        box-shadow: rgba(255,255,255,.9) 0px 1px 0px inset,
        rgba(0,0,0,.03) 0px -1px 0px inset,
        rgba(0,0,0,.2) 0px 1px 3px;
      }

      .x-navbar, .x-flat-navbar {
        position:fixed;
        width:100%;
        top:0;
        height:70px;
        background-color:#fff;
        color:#404040;
        z-index:2;
      }

      .x-navbar {
        box-shadow:0px 1px 4px rgba(0,0,0,.34);
      }

      .x-flat-navbar {
        border-bottom: solid 1px rgba(0, 0, 0, 0.15);
      }

      ul.x-navbar-nav {
        list-style:none;
        padding:0;
        margin:0;
      }

      .x-navbar-nav > li {
        position:relative;
        display:block; /* need this to have it fit the navbar length */
        float:left; /* so the li elements displayed inline even though its a block element */
      }

      .x-navbar-nav > li > a {
        display:block; /* need this to have it fit the navbar length */
        line-height:70px;
        font-size:14px;
        font-weight:500;
        padding:0 5px 0 5px;
        height:70px;
        text-decoration: none;
        color:inherit;
        transition:all 150ms ease-in-out;
        border-bottom:solid 0 rgba(0,0,0,0);
      }

      .x-navbar-nav > li:hover > a, .x-navbar-nav > li.active > a {
        border-bottom:solid 5px #aaa;
      }

      .x-navbar-nav > li:hover > a:hover {
        color:rgba(0,0,0,.5);
      }

      .x-navbar-nav > li > a, .x-navbar-nav > li > a:hover, .x-navbar-nav > li > a:visited {
        text-decoration:none;
        color:inherit;
      }

      .x-flat-btn {
        cursor:pointer;
        text-align:center;
        border:solid 1px transparent;
        border-radius: 2px;
        display:inline-block;
        vertical-align: middle;
        padding:4px 8px;
        font-size: 14px;
      }

      .x-flat-btn:hover {
        border:solid 1px rgba(0,0,0,0.03);
        background-color:rgba(0,0,0,0.1);
      }

      .x-menu {
        background:#fff;
        position:absolute;
        white-space: nowrap;
        list-style:none;
        border:none;
        border-radius:2px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        text-align:left;
        padding:5px 0;
        margin:0;
        z-index:1000;
      }

      /* shared with before and after */
      .x-menu::before, .x-menu::after {
        content: ' ';
        height: 0;
        position: absolute;
        width: 0;
        border: 10px solid transparent; /* arrow size */
      }

      /* these arrows will point up */

      /* top-stacked, smaller arrow */
      .x-menu::before {
        border-bottom-color: #fff;  /* arrow color */

        /* positioning */
        position: absolute;
        top: -19px;
        right: 10px;
        z-index: 2;
      }

      /* arrow which acts as a background shadow */
      .x-menu::after {
        border-bottom-color: rgba(0,0,0,0.05);  /* arrow color */

        /* positioning */
        position: absolute;
        top: -20px;
        right: 10px;
        z-index: 1;
      }

      .x-menu > .x-menu-item {
        padding:5px 20px;
        display:block;
        cursor:pointer;
        width:100%;
        position:relative;
        line-height:24px;
      }

      .x-menu > .x-menu-item.selected {
        font-weight: bold;
      }

      .x-menu > .x-menu-item.selected::after {
        content: "\f00c";
        font: normal normal normal 14px/1 FontAwesome;
        font-size:inherit;
        display:inline-block;
        position:absolute;
        right:20px;
        top:10px;
      }

      .x-menu > .x-menu-item:hover {
        background-color:rgba(0,0,0,.05);
      }

      .marker-arrow {
        fill: rgba(255, 255, 255, 1);
        stroke-opacity: 0;
        stroke-width: .25em;
      }

      .link {
        opacity: .3;
        stroke: #eee;
        stroke-width: .25em;
      }

      .node-rect {
        stroke-width: 0;
        fill: #fff;
      }

      .curved-shadow {
        position:relative;
      }

      .curved-shadow::before {
        transition: opacity .3s ease;
        content: "";
        position:absolute;
        z-index: -1;
        width:96%;
        bottom: 0;
        height: 10px;
        left: 2%;
        border-radius: 100px / 5px;
        box-shadow:0 0 10px 4px rgba(0,0,0,0.25);
        opacity:0;
      }

      .curved-shadow.show::before {
        opacity:1;
      }

      .left-panel {
        padding:0 20px;
        position:fixed;
        top:110px;
        left:0;
        width:260px;
      }

      .main-panel {
        margin-top:90px;
        width:1260px;
        padding:0 10px;
        overflow:hidden;
      }

      .thumbnails-list-toolbar {
        background-color:#fff;
        position:fixed;
        width:80%;
        height: 43px;
        z-index:1;
      }

      .thumbnails-list-toolbar > div {
        background-color:inherit;
        padding:5px 0 5px 0;
        border-bottom: solid 1px rgba(0,0,0,0.20);
      }

      .thumbnails-list-toolbar .toolbar-buttons {
        float:right;
        right:0;
        bottom:0;
      }

      .toolbar-dropdown {
        width:180px;
        right:0px;
        top:40px;
      }

      .toolbar-buttons {
        float:right;
        margin-right:20px;
        margin-top:15px;
      }

      .toolbar-buttons > * {
        display:inline-block;
        position:relative;
      }

      .toolbar-buttons .x-flat-btn {
        line-height:20px;
        font-size: 17px;
        width:40px;
      }

      .thumbnails-list {
        margin-top:63px;
      }

      .thumbnails-list > a {
        display:inline-block;
        margin-right:15px;
        margin-bottom:15px;
        text-decoration: none;
        color:inherit;
      }

      .thumbnails-list > a:nth-child(3n) {
        margin-right:0;
      }

      .thumbnails-list > a:hover, .thumbnails-list > a:visited {
        color:inherit;
        text-decoration: none;
      }

      .graph-thumbnail {
        cursor:pointer;
        overflow:hidden;
        border-radius:2px;
        background-color:#fff;
        display:inline-block;
        box-shadow: 0px 1px 8px rgba(0, 0, 0, .2),
                    0px 0px 2px rgba(0, 0, 0, .2),
                    inset 0px 1px 0px rgba(255, 255, 255, .25),
                    inset 0px -1px 0px rgba(0, 0, 0, .15);
      }

      .graph-thumbnail > svg {
        background-color:#e74c3c;
        display:block;  /* SVG element default to display:inline; which causes weird padding/margin issues */
        width:400px;
        height:220px;
      }

      .graph-thumbnail > .caption {
        position:relative;
        padding:5px 10px;
      }

      .graph-thumbnail > .caption > .fa {
        position:absolute;
        right:10px;
        top:17px;
      }

      .nav > .x-navbar-nav {
        margin-left:20px;
      }

      .nav > img {
        position:absolute;
        bottom:10px;
        right:20px;
        border-radius:2px;
      }

      .sub-nav {
        top:70px;
        height:60px;
        background: #fff;
      }

      .sub-nav > button {
        padding:8px 16px;
        display:inline-block;
        width:160px;
        margin-top:10px;
        margin-left:20px;
      }
    </style>
  </head>
  <body>
    <div class="x-flat-navbar nav">
      <ul class="x-navbar-nav">
        <li class="active">
          <a href="#">Graphs</a>
        </li>
        <li>
          <a href="#">Profile</a>
        </li>
      </ul>
      <img src="https://secure.gravatar.com/avatar/@userHash?s=100" width="50" height="50" />
    </div>

    <div class="x-flat-navbar sub-nav">
      <button type="button" class="btn btn-default btn-lg btn-block">New Graph</button>
      <div class="toolbar-buttons">
        <span>
          <i class="x-flat-btn fa fa-list"></i>
        </span>
        <span>
          <i class="x-flat-btn fa fa-sort" v-on="click:toggleSortMenu"></i>
          <ul class="x-menu toolbar-dropdown" v-class="hidden:!sortMenu" v-cloak>
            <li class="x-menu-item" v-class="selected:sortedBy=='created'" v-on="click:sortedBy='created'">
              Date created
            </li>
            <li class="x-menu-item" v-class="selected:sortedBy=='modified'" v-on="click:sortedBy='modified'">
              Date modified
            </li>
            <li class="x-menu-item" v-class="selected:sortedBy=='title'" v-on="click:sortedBy='title'">
              Title
            </li>
          </ul>
        </span>
      </div>
    </div>

    <div class="main-panel center-block">
      <div class="thumbnails-list">
        <x-graph-thumbnail v-repeat="sortedHypergraphs"></x-graph-thumbnail>
      </div>
    </div>
  </body>

  <template id="link.thumbnail">
    <g>
      <line
          class="link"
          v-attr="x1:sourceX, y1:sourceY, x2:targetClipX, y2:targetClipY"
      ></line>
      <line
          class="marker-arrow"
          marker-end="url(#def-marker-arrow)"
          v-attr="x1:sourceX, y1:sourceY, x2:targetClipX, y2:targetClipY"
      ></line>
    </g>
  </template>

  <template id="node.thumbnail">
    <g
        class="node enable-pointer-events"
        v-attr="id: id, transform: nodeTranslate"
    >
      <rect
          class="node-rect"
          rx="2"
          ry="2"
          v-el="nodeRect"
          v-attr="width:width, height:height, transform:rectTranslate"
          ></rect>
      <text
          class="node-name x-disable-pointer-events"
          text-anchor="middle"
          v-el="nodeName"
      >
        {{data.name}}
      </text>
    </g>
  </template>

  <template id="graph.thumbnail">
    <a href="/graph/{{graph.id}}">
      <div class="graph-thumbnail">
        <svg
            style="background-color:#{{graph.data.background}};"
            preserveAspectRatio="xMidYMid meet"
            v-attr="viewBox:viewBox"
            v-el="svg">
          <defs>
            <marker
                id="def-marker-arrow"
                markerWidth="2"
                markerHeight="2"
                refx="1.6"
                refy="1"
                orient="auto"
            >
              <path d="M0,0 L0,2 L2,1 L0,0" class="marker-arrow"></path>
            </marker>
            <marker
                id="def-marker-ghost-arrow"
                markerWidth="2"
                markerHeight="2"
                refx="0"
                refy="1"
                orient="auto"
            >
              <path d="M0,0 L0,2 L2,1 L0,0" class="marker-arrow"></path>
            </marker>
          </defs>

          <g class="x-disable-pointer-events" v-el="nodesAndLinksGroup">
            <!-- Nodes -->
            <x-node-thumbnail v-repeat="nodes"></x-node-thumbnail>

            <!-- Links -->
            <x-link-thumbnail v-repeat="links"></x-link-thumbnail>
          </g>
        </svg>
        <div class="caption">
          <h6>{{graph.data.name}}</h6>
        </div>
      </div>
    </a>
  </template>

  <script>
    var userGraphs = @Html(Json.stringify(hypergraphs)); //bootstrap json data into view template
  </script>

  <script
      data-main="@routes.Assets.at("js/account/main")"
      src="@routes.Assets.at("js/dependencies/require.js")"></script>
</html>